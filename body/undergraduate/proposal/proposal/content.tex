\section{项目的主要内容和技术路线}

\subsection{主要研究内容}


\subsection{技术路线}
对初始波函数使用Wigner变换，即
\begin{equation}
	P\left(x_{i} ; p_{i}\right)=\left(\frac{1}{h \pi}\right)^{n} \int_{-\infty}^{\infty} d y_{i} \psi\left(x_{i}+y_{i}\right)^{*} \psi\left(x_{i}-y_{i}\right) e^{2 i \sum p_{i} y_{i} / \hbar}
\end{equation}

若初始波函数具有多项式高斯函数的形式，即
\begin{equation}
	G(\boldsymbol{X}) = \mathcal{L}(\boldsymbol{X}) \exp{ \left( - \frac{1}{2} \boldsymbol{X}^T \mathcal{A} \boldsymbol{X} + \boldsymbol{B} \boldsymbol{X}\right)   }	
\end{equation}
其中$\mathcal{L}(\boldsymbol{X})$为以$\boldsymbol{X}$中所有变量$\{x_i\}$表达的多项式，$\mathcal{A}$为高斯函数部分的二次项，$\boldsymbol{B}$为高斯函数部分的一次项。则对应的在相空间中的分布能够以解析的形式给出，
\begin{equation}
	\begin{aligned}
		P(\boldsymbol{X};\boldsymbol{P}) =& \left( \frac{1}{\hbar \pi} \right) ^n e^{-\boldsymbol{X}^T \mathcal{A} \boldsymbol{X}} e^{2\boldsymbol{B}^T\boldsymbol{X}} \left(\det \mathcal{A'}\right)^{-\frac{1}{2}} \det \mathcal{U}\times \\
	&\mathcal{L}\left(\boldsymbol{X} - i\mathcal{U} \frac{\partial }{\partial \boldsymbol{X}} \right)\mathcal{L}\left(\boldsymbol{X} + i \mathcal{U} \frac{\partial }{\partial \boldsymbol{X}} \right)\exp \left( - \boldsymbol{P}^T \mathcal{A}'\boldsymbol{P} \right)  
\end{aligned}
\end{equation} 
其中$\mathcal{D}$为$\mathcal{A}$进行对角化后得到的矩阵，$\mathcal{U}$为对应的线性变换矩阵，即
 \begin{equation}
	 \begin{cases}
	 \mathcal{A} = \mathcal{U} \mathcal{D} \mathcal{U}^T\\
	 \mathcal{D} = \diag\left( \lambda_1, \lambda_2, ..., \lambda_n \right) 
         \end{cases}
\end{equation}
而$\mathcal{A}'$为高斯函数进行傅立叶变换后的结果，其形式满足
 \begin{equation}
\begin{cases}
	\mathcal{A'} = \mathcal{U} \mathcal{D}' \mathcal{U}^T \\
	\mathcal{D'} = \frac{1}{\hbar^2}\mathcal{D}^{-1} = \diag \left( \frac{1}{\lambda_1 \hbar^2}, \frac{1}{\lambda_2 \hbar^2}, ..., \frac{1}{\lambda_n \hbar ^2} \right) 
\end{cases}
\end{equation} 
因此多项式高斯函数的相空间分布形式仍旧为多项式高斯函数。

在具体的计算过程中，我们使用原子单位制，即$\hbar = 1$。

利用Wigner分布得到相空间分布后，我们对相空间分布进行格点离散化，其方式模仿Arnaldo Donoso，Daniela Kohen 与Craig C. Martens 合箸的文章\cite{donoso2000simulation}：
\begin{equation}
\rho_{i j}(\Gamma, t)=\sum_{n=1}^{N} a_{n}^{(i j)}(t) \delta\left(\Gamma-\Gamma_{n}^{(i j)}(t)\right)
\end{equation} 
从而将相空间分布化简为多个互相之间不存在相互作用的粒子，而后对每个粒子进行单独演化。原文章只使用了最经典的分子动力学框架，即只使用泊松括号（Poisson's Bracket)对粒子进行演化，
\begin{equation}
	i \hbar \frac{\partial \hat{\rho}}{\partial t}=[\hat{H}, \hat{\rho}] \sim i \hbar\{A, B\}+O\left(\hbar^{3}\right)
\end{equation}
其中
\begin{equation}
	\{H, \rho\}=\frac{\partial H}{\partial q} \frac{\partial \rho}{\partial p}-\frac{\partial \rho}{\partial q} \frac{\partial H}{\partial p}
\end{equation}
因此该框架在含时演化过程中并不包含任何量子修正。因此我们考虑利用SMD框架对可观察量的变化进行修正，
\begin{equation}
	\frac{d}{d t}\langle A\rangle=\left\langle\frac{\partial A}{\partial t}\right\rangle+\langle\{\{A, H\}\}\rangle
	\label{Ehrenfest_in_proposal}
\end{equation}
其中
 \begin{equation}
	 \{\{f, g\}\}=\frac{2}{\hbar} f \sin \left[\frac{\hbar}{2}\left(\sum_{i} \overleftarrow{\partial}_{q_{i}} \overrightarrow{\partial}_{p_{i}}-\overleftarrow{\partial}_{p_{i}} \overrightarrow{\partial}_{q_{i}}\right)\right] g
\end{equation}
由此我们可以在含时演化过程中仍旧包含有量子修正，而如何实现这样的修正则为本次课题的重点。

本次所用程序依附于\emph{entos}的框架，该程序以C++14作为核心语言，其程序结构具有较大的灵活性，严谨的软件工程标准，同时实现了以任务为核心的多核并行计算框架\cite{Manby2019}。计算平台使用浙江大学西溪校区化学系曙光TC6000高性能计算机平台。

\subsection{可行性分析}
在化学体系中电子由于原子核的束缚处于局域态，同时原子核由于其极大的质量亦处于局域态，满足的边界条件为在无穷远处波函数值为零，即
\begin{equation}
	| \psi \rangle \big|_{\boldsymbol{r}\rightarrow \infty} = 0
\end{equation} 
因此我们能够通过高斯函数或多项式高斯函数对电子结构或核的波函数进行拟合，正如正常电子结构中对电子波函数使用高斯函数拟合。而由于高斯函数能够给出解析的傅立叶变换，我们能够在进行初始Wigner变换的过程中不丢失对原来的初始波函数的信息。同时其高度局域的性质能使相空间的格点化或是采样的过程简化的同时减小精度损失。在半经典磨雅动力学的原文献中\cite{LinjunSemiclassical}只采用了不含多项式的一维高斯函数，适用领域较小，而若利用多项式高斯函数的解析Wigner变换能够获得更广的应用场景，如单电子在三维体系下的演化。

对相空间分布进行粒子化的最大的好处来源于狄拉克函数在积分中的简化能力：
\begin{equation}
	\int f(x;p) \delta (x- x_0) \delta (p- p_0) \, dx dp = f(x_0;p_0)
\end{equation}
从而能够省去大量的解析计算的时间成本。而分子动力学模拟一直以高效率与卓越的稳定性而被众多理论化学研究者所使用，这是由于经典力学框架只依赖一阶力学量——即位移$x$和动量$p$，而狄拉克函数的确定恰恰只需要这两个变量作为先知条件，因此分子动力学模拟能够自恰。然而若需要通过SMD框架引入量子力学修正，则根据公式(\ref{Ehrenfest_in_proposal})，我们不能再次得到新的狄拉克函数——即狄拉克函数在量子力学框架下进行演化后不再是狄拉克函数。譬如，在一个简谐振子体系下哈密顿量表达式为
\begin{equation}
	\hat{H} = \frac{p^2}{2} + \frac{x^2}{2}
\end{equation}
其中质量和弹簧系数皆设为1.利用公式(\ref{Ehrenfest_in_proposal})我们能够得到一阶项
\begin{equation}
	\begin{cases}
	\frac{d }{dt}\langle x \rangle = \langle p \rangle \\
	\frac{d }{dt}\langle p \rangle = - \langle x \rangle
	\end{cases}
\end{equation}
对于一狄拉克函数$f(x,p) = \delta(x-x_0)\delta(p-p_0)$,若只考虑一阶项的演化，经过$dt$时间演化后的函数形式可解析得到为
\begin{equation}
f(x,p) \big|_{t=dt} = \delta(x-x_0 - p_0dt) \delta(p-p_0+x_0dt)
\end{equation}
我们定义通过狄拉克函数演化得到的各力学量$\xi$对时间的偏导与磨雅括号得到的各力学量随时间的偏导的差为$D(\xi)$，即
\begin{equation}
	D(\xi) \equiv \frac{\int \xi \, f(x,p) \big|_{t=dt} \, dx dp - \int \xi \, f(x,p) \big|_{t=0} \, dx dp }{dt} - \{\{\xi,\hat{H}\}\}
\end{equation}
在这里罗列二阶项，
\begin{equation}
	\begin{cases}
		D(x^2) = p_0^2 dt \\
		D(x p) = - x_0 p_0 dt \\
		D(p^2) = x_0^2 dt
	\end{cases}
\end{equation}
以及三阶项，
\begin{equation}
	\begin{cases}
		D(x^3) = 3 p_0^2 x_0 dt + p_0^3 dt^2\\
		D(x^2 p) = p_0^3 dt - 2 p_0 x_0^2 dt - x_0p_0^2 dt^2\\
		D(x p^2) = x_0^3 dt + 2x_0 p_0^2 dt + p_0 x_0^2 dt^2 \\
		D(p^3) = 3 p_0 x_0^2 dt - x_0^3 dt^2
	\end{cases}
\end{equation}
该推导说明了在经过$dt$时间后每一个高于一阶的项都至少存在$dt$级别的误差，其间接说明了分子动力学模拟与全量子模拟之间的差距，以及狄拉克函数近似的一些缺陷。然而它同时又能说明分子动力学模拟的数值稳定性——由于所有变量的误差都只依赖于同阶的力学量，所以不会像辅助相空间分布一样由于依赖高阶变量而产生数值崩坏的现象。因此，若在原有的分子动力学模拟的基础上考虑量子力学修正，我们必须要对经过一个时间元后的新的函数进行一些变换，对高阶项的$dt$误差项进行修正。正因为误差只有$dt$项，故这样的修正是可行的，却也有相当的难度，因为狄拉克函数的确定只依赖于所有一阶项或其同等数量的变量来得到。若想要对高阶量的演化进行修正，我们可以考虑的方法包括：
\begin{itemize}
	\item 对新得到的狄拉克函数进行极小的位移，使综合所有力学量演化的误差达到最小。该想法最为平凡，是少变量面对多变量情况下的最小误差的求解。然而该方法会反而对最重要的一阶项的期望值带来误差，存在一定可能恶化最后的模拟结果。
	\item 引入新的狄拉克函数并进行线性组合来调整误差。该想法为上一想法的延伸，通过引入新的狄拉克函数来增加变量，从而完成完整的截断。然而该方法的最大问题来源于引入新的狄拉克函数导致的计算量随时间膨胀的问题，因为每一个时间元下的演化都会引入至少同等于原来的狄拉克函数数量的新的狄拉克函数，并不适合实际体系。
	\item 使用格点空间来描述新的狄拉克函数。由于我们想要固定所有的基组函数的数量，我们想要通过固定的格点空间来拟合这样的``波包分裂''的现象，然而其丧失了狄拉克函数的中心的自由度及相对应的分子动力学模拟的灵活性，期望效果十分有限。
	\item 将演化后的新的函数用基组来展开。而该方案即为顾锴的多中心基组的另一种表达方式，且该基组的后续演化又会重复原先的辅助相空间分布的演化过程，可谓重蹈覆辙。
	\item 使用格点空间拟合的相空间分布来修正使用新的狄拉克函数带来的误差，换言之将整个相空间分布的演化划分为固定狄拉克函数部分和活动狄拉克函数部分。该方案利用格点化的空间来充当``垃圾桶''，用于消除狄拉克函数的变化带来的误差，同时自身又以固定的狄拉克函数参与下一时刻的演化。该方法能够充分利用了分子动力学模拟的灵活性与狄拉克函数的数值稳定性，同时通过引入固定格点来避免计算量的膨胀。然而该方法基本意味着两倍的计算量，同时固定狄拉克函数的演化依旧值得探讨。
\end{itemize}